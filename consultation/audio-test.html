<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audio Test - Consultation System</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-6">
        <h1 class="text-2xl font-bold text-gray-800 mb-6">üîä Audio Notification Test</h1>
        
        <div class="space-y-4">
            <div class="bg-blue-50 p-4 rounded-lg">
                <h2 class="font-semibold text-blue-800 mb-2">Test Instructions:</h2>
                <ol class="list-decimal list-inside text-blue-700 space-y-1">
                    <li>Click any button below to enable audio playback</li>
                    <li>Test the MP3 notification sound</li>
                    <li>Test the fallback beep sound</li>
                    <li>Check browser console for any errors</li>
                </ol>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <button id="testMp3" class="bg-green-500 hover:bg-green-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                    üéµ Test MP3 Sound
                </button>
                
                <button id="testBeep" class="bg-yellow-500 hover:bg-yellow-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                    üîä Test Beep Sound
                </button>
                
                <button id="testContinuous" class="bg-purple-500 hover:bg-purple-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                    üîÑ Test Continuous Sound
                </button>
                
                <button id="stopSound" class="bg-red-500 hover:bg-red-600 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                    ‚èπÔ∏è Stop All Sounds
                </button>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg">
                <h3 class="font-semibold text-gray-800 mb-2">Status:</h3>
                <div id="status" class="text-gray-600">Ready to test audio...</div>
            </div>
            
            <div class="bg-gray-50 p-4 rounded-lg">
                <h3 class="font-semibold text-gray-800 mb-2">Console Log:</h3>
                <div id="consoleLog" class="bg-black text-green-400 p-3 rounded font-mono text-sm h-32 overflow-y-auto">
                    Console output will appear here...
                </div>
            </div>
        </div>
    </div>

    <script>
        let notificationAudio = null;
        let soundInterval = null;
        let userInteracted = false;
        
        // Override console.log to display in the page
        const originalLog = console.log;
        const originalError = console.error;
        
        function logToPage(message) {
            const consoleLog = document.getElementById('consoleLog');
            const timestamp = new Date().toLocaleTimeString();
            consoleLog.innerHTML += `[${timestamp}] ${message}\n`;
            consoleLog.scrollTop = consoleLog.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            logToPage(args.join(' '));
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            logToPage('ERROR: ' + args.join(' '));
        };
        
        // Enable audio playback on user interaction
        function enableAudio() {
            if (!userInteracted) {
                userInteracted = true;
                console.log('‚úÖ User interaction detected, audio playback enabled');
                document.getElementById('status').textContent = 'Audio enabled - ready to test!';
            }
        }
        
        // Test MP3 sound
        document.getElementById('testMp3').addEventListener('click', function() {
            enableAudio();
            console.log('üéµ Testing MP3 notification sound...');
            
            try {
                const audio = new Audio('notification-sound.mp3');
                audio.volume = 0.3;
                
                audio.addEventListener('loadstart', () => console.log('üì• Audio loading started'));
                audio.addEventListener('canplay', () => console.log('‚úÖ Audio can play'));
                audio.addEventListener('canplaythrough', () => console.log('‚úÖ Audio can play through'));
                audio.addEventListener('error', (e) => console.log('‚ùå Audio error:', e));
                audio.addEventListener('ended', () => console.log('üèÅ Audio playback ended'));
                
                audio.play().then(() => {
                    console.log('‚úÖ MP3 audio played successfully');
                }).catch(e => {
                    console.log('‚ùå MP3 audio failed:', e.message);
                });
            } catch (e) {
                console.log('‚ùå MP3 audio not supported:', e.message);
            }
        });
        
        // Test beep sound
        document.getElementById('testBeep').addEventListener('click', function() {
            enableAudio();
            console.log('üîä Testing beep sound...');
            
            try {
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT');
                audio.volume = 0.3;
                
                audio.play().then(() => {
                    console.log('‚úÖ Beep sound played successfully');
                }).catch(e => {
                    console.log('‚ùå Beep sound failed:', e.message);
                });
            } catch (e) {
                console.log('‚ùå Beep sound not supported:', e.message);
            }
        });
        
        // Test continuous sound
        document.getElementById('testContinuous').addEventListener('click', function() {
            enableAudio();
            console.log('üîÑ Testing continuous notification sound...');
            
            // Stop any existing sound
            if (notificationAudio) {
                notificationAudio.pause();
                notificationAudio = null;
            }
            if (soundInterval) {
                clearInterval(soundInterval);
                soundInterval = null;
            }
            
            try {
                notificationAudio = new Audio('notification-sound.mp3');
                notificationAudio.volume = 0.3;
                
                notificationAudio.play().catch(e => {
                    console.log('‚ùå Continuous audio failed:', e.message);
                });
                
                // Set up continuous playback every 3 seconds
                soundInterval = setInterval(() => {
                    if (notificationAudio) {
                        notificationAudio.currentTime = 0;
                        notificationAudio.play().catch(e => {
                            console.log('‚ùå Continuous audio playback failed:', e.message);
                        });
                    }
                }, 3000);
                
                console.log('‚úÖ Continuous notification sound started');
            } catch (e) {
                console.log('‚ùå Continuous audio not supported:', e.message);
            }
        });
        
        // Stop all sounds
        document.getElementById('stopSound').addEventListener('click', function() {
            console.log('‚èπÔ∏è Stopping all sounds...');
            
            if (notificationAudio) {
                notificationAudio.pause();
                notificationAudio.currentTime = 0;
                notificationAudio = null;
            }
            
            if (soundInterval) {
                clearInterval(soundInterval);
                soundInterval = null;
            }
            
            console.log('‚úÖ All sounds stopped');
        });
        
        // Add click event to enable audio
        document.addEventListener('click', enableAudio);
        document.addEventListener('keydown', enableAudio);
        
        console.log('üéµ Audio test page loaded');
        console.log('üí° Click any button to enable audio playback');
    </script>
</body>
</html>
